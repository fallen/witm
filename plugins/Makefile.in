CFLAGS += -shared -Wall -Wextra -g -O0 -I../ `pcap-config --cflags` `dnet-config --cflags` -DDNET_NAME=\<$(DNET_NAME)\>
LDLIBS += -shared `pcap-config --libs` `dnet-config --libs` -L../ -lpthread -ldl

SRC = $(wildcard *.c)
OBJ = $(SRC:.c=.o)
SHAREDOBJ = $(SRC:.c=.so)
PROTOCOLS = ../ip.o

all: $(SHAREDOBJ)

$(OBJ): $(SRC)
	$(CC) -c $(CFLAGS) $(@:.o=.c)

$(SHAREDOBJ): $(OBJ)
	$(CC) $(LDLIBS) $(@:.so=.o) $(PROTOCOLS) -o $@

clean:
	rm -f $(OBJ)

distclean: clean
	rm -f $(SHAREDOBJ)

re: distclean all
